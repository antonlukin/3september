!function(){var t=null,n=Date.now(),r=document.getElementById("calendar"),o=document.getElementById("sound"),a=document.getElementById("video"),c=0;function i(e){var t=[" раз"," раза"," раз"][4<e%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]];return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+t}function e(){(t=new WebSocket("wss://3september.ru:8000")).onmessage=function(e){var t=document.querySelector(".counter--more");t.querySelector("strong").innerHTML=i(e.data),t.classList.remove("counter--hidden")},t.onclose=function(){!function(){if(!t||t.readyState==WebSocket.CLOSED)e()}()},t.onerror=function(e){console.error("WebSocket error observed: ",e)}}function d(){localStorage.setItem("count",++c);var e=document.querySelector(".counter--title");e.querySelector("strong").innerHTML=i(c),e.classList.remove("counter--hidden");var t=r.querySelector(".calendar__page:last-child");t.classList.add("calendar__page--animate"),t.addEventListener("animationend",function e(){t.classList.remove("calendar__page--animate"),t.removeEventListener("animationend",e)})}function s(e,t){e=e.split("");for(var n,r,o=0,a=0;o<3*e.length||o<10;o++){var c=(n=10,r=15,n=Math.ceil(n),r=Math.floor(r),(Math.floor(Math.random()*(r-n+1))+n).toString(16));o%3==1&&a<e.length&&(c=(9-e[a++]).toString()),t+=c}return t}o.addEventListener("click",function(e){return e.preventDefault(),o.classList.add("sound--stop","sound--clicked"),a.muted?(o.classList.remove("sound--stop"),a.muted=!1):a.muted=!0}),r.addEventListener("click",function(e){if(e.preventDefault(),1500<Date.now()-n)return n=Date.now(),t&&t.readyState==WebSocket.OPEN&&t.send("update"),!o.classList.contains("sound--clicked")&&a.muted&&o.click(),d()}),setInterval(function(){t&&t.readyState==WebSocket.OPEN&&t.send("receive")},5e3),localStorage.getItem("count")&&(c=parseInt(localStorage.getItem("count"))),document.addEventListener("DOMContentLoaded",d);for(var l=document.querySelectorAll(".share"),u=0;u<l.length;u++)l[u].addEventListener("click",function(e){return e.preventDefault(),function(e,t){e=e+"/social/"+s(c.toString(),"");var n=Math.round(screen.width/2-t.width/2),r=0;return screen.height>t.height&&(r=Math.round(screen.height/3-t.height/2)),window.open(e,t.id,"left="+n+",top="+r+",width="+t.width+",height="+t.height+",personalbar=0,toolbar=0,scrollbars=1,resizable=1")}(this.href,(this.dataset.label,{width:600,height:400,id:this.dataset.label}))});e()}();